C/C++ code for BDM
