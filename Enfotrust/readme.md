Most interesting code is Snoopy.cpp
